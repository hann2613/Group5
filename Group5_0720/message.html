<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>StudentPreneur Message</title>
    <link rel="stylesheet" href="style5.css" />
  </head>
  <body>
    <header>
      <nav>
        <div class="logo"><a href="post.html">StudentPreneur</a></div>
        <a href="post.html">Home</a>
        <a href="learning.html">Learning</a>
        <a href="event.html">Events</a>
        <a href="globalConnections.html">Global Connections</a>
        <div class="teamup">
          <button
            onclick="window.location.href = 'teamup1.html'"
            class="teamup-btn"
          >
            Team Up
          </button>
          <div class="profile-icon"><a href="profile.html"></a></div>
        </div>
      </nav>
    </header>

    <main id="app">
      <section class="chat-container">
        <div class="chat-messages">
          <div
            v-for="(message, index) in messages"
            :key="index"
            class="message"
          >
            <strong>{{ message.user }}:</strong> {{ message.text }}
          </div>
        </div>
        <div class="chat-input">
          <input
            type="text"
            v-model="newMessage"
            @keyup.enter="sendMessage"
            placeholder="Type your message..."
          />
          <button @click="sendMessage">Send</button>
        </div>
      </section>
    </main>

    <footer>
      <p>&copy; 2024 StudentPreneur. All rights reserved.</p>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/vue@2.6.14/dist/vue.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <script>
      new Vue({
        el: "#app",
        data: {
          messages: [],
          newMessage: "",
        },
        methods: {
          sendMessage() {
            if (this.newMessage.trim() === "") return; // Prevent sending empty messages

            axios
              .post("http://localhost:8000/api/send_message.php", {
                user: "User",
                text: this.newMessage,
              })
              .then((response) => {
                console.log("Message sent successfully:", response.data);
                this.newMessage = "";
                this.fetchMessages();
              })
              .catch((error) => {
                console.error("Error sending message:", error);
              });
          },
          fetchMessages() {
            axios
              .get("http://localhost:8000/api/get_messages.php")
              .then((response) => {
                this.messages = response.data;
                // Assuming response.data is an array of message objects
              })
              .catch((error) => {
                console.error("Error fetching messages:", error);
              });
          },
        },
        mounted() {
          this.fetchMessages();
        },
      });
    </script>
  </body>
</html>
